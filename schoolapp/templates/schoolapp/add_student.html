{% load static %}
<!DOCTYPE html>
<html>
<head>
    <title>Add Student</title>
    <link rel="stylesheet" href="{% static 'css/styleee.css' %}">
</head>
<body>
    <div class="centered-container">
        <h2>Add Student or Task</h2>

        <form method="POST">
            {% csrf_token %}
            <button type="submit" name="show_student_form" class="btn">Add Student Details</button>
            <button type="submit" name="show_task_form" class="btn">Add Task</button>
        </form>

        {% if show_student_form %}
        <form method="POST">
            {% csrf_token %}
            {{ student_form.as_p }}
            {{ subject_formset.management_form }}
            {% for form in subject_formset %}
                {{ form.as_p }}
            {% endfor %}
            <button type="submit" name="submit_student" class="btn">Submit Student</button>
        </form>
        {% endif %}

        {% if show_task_form %}
        <form method="POST">
            {% csrf_token %}
            <label>Select Student:</label>
            <select name="student_id">
                {% for student in students %}
                    <option value="{{ student.id }}">{{ student.name }}</option>
                {% endfor %}
            </select>
            {{ task_form.as_p }}
            <button type="submit" name="submit_task" class="btn">Submit Task</button>
        </form>
        {% endif %}
    </div>

    <hr>
    <div class="student-list">
        <h3>ðŸ“‹ All Students</h3>
        {% for student in students %}
            <div class="student-card">
                <strong>Name:</strong> {{ student.name }} <br>
                <strong>Roll No:</strong> {{ student.roll_number }} <br>
                <strong>Class:</strong> {{ student.student_class }} <br>
                <strong>Attendance:</strong> {{ student.attendance }}% <br>
                <strong>Subjects:</strong>
                <ul>
                    {% for subject in student.subjects.all %}
                        <li>{{ subject.name }} - {{ subject.percentage }}%</li>
                    {% endfor %}
                </ul>
                <strong>Tasks:</strong>
                <ul>
                    {% for task in student.task_set.all %}
                        <li><strong>{{ task.title }}</strong>: {{ task.description }}</li>
                    {% empty %}
                        <li>No tasks yet.</li>
                    {% endfor %}
                </ul>
            </div>
        {% empty %}
            <p>No student data found.</p>
        {% endfor %}
    </div>
</body>
</html>
